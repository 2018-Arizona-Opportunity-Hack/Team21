<script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js'></script>
<style media="screen">
  #hova:hover{
    background-color: blue
  }
</style>
<div class="container">
<br>
<h1>Upload CSV</h1><hr>
<!-- See https://stackoverflow.com/questions/14446447/how-to-read-a-local-text-file -->
<div class="">

<form action="/csv" method="post">
<b>  <label for="csvdata" class='label'>Data:</label></b>
<input class='form-control' style='width:30rem' type="file" onchange='openFile(event)' name="csvraw"/>
<input type="text" style='margin-top:-2.5rem;margin-left:32rem;width:30rem' class='form-control' onkeydown='search()' id='group' placeholder='Group Name' name="group" value=""><br>
<div style='margin-top:-1.5rem;margin-left:32rem;width:30rem;height:1.7rem;display:none;' class="hova card" id='setme'>

</div>
  <br>
  <textarea class='form-control' rows="15" style='width:30rem' id="csvdata" name="csvdata" placeholder="Paste Data here"></textarea>
  <br>

  <button style='margin-left:57.2rem' class='btn btn-info'>Submit</button>
</form>
</div>




</div>
<script>
var openFile = function(event){
    var input = event.target;
    var reader = new FileReader();
    reader.onload = function(){
        var text = reader.result;
        var node = document.getElementById('csvdata');
        node.value = text;
        console.log(reader.result.substring(0, 200));
    };
    reader.readAsText(input.files[0]);

}
var groups = []
var set = document.getElementById('setme')
function search(){
  var groupData = document.getElementById('group').value.toLowerCase()

  console.log(groupData);
  if (groupData == '') {
    groups = ''
    set.innerHTML =  '<p></p>'
    set.style.display = 'none'

  }
  else{

axios.post('/search', {'data': groupData}).then(function(data){
  console.log(data.data[0].name);
    groups = data.data[0].name
    set.innerHTML =  '<p>' + data.data[0].name + '</p>'
    set.style.display = 'block'

})
}


}

</script>
